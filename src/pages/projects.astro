---
import Base from "../layouts/Base.astro";
import { getAllProjects } from "../lib/projects";

const allProjects = getAllProjects();

/* GROUPS BY SLUG */
const MOBILE_SLUGS = [
  "warriors-merge",
  "ice-slingers",
  "orbit-defense",
  "castle-force-td",
  "peg-slinger",
  "super-strike",
  "chaos-squad",
  "slime-hunt",
  "survive-the-void",
  "mr-gish"
];

const PC_SLUGS = [
  "devoured",
  "a-way-back",
  "iris"
];

const JAM_SLUGS = [
  "vertical-slice",
  "bound-survivors"
];

/* FILTER PROJECTS INTO GROUPS */
const mobileProjects = allProjects
  .filter((p) => MOBILE_SLUGS.includes(p.slug))
  .sort((a, b) => MOBILE_SLUGS.indexOf(a.slug) - MOBILE_SLUGS.indexOf(b.slug));

const pcProjects = allProjects
  .filter((p) => PC_SLUGS.includes(p.slug))
  .sort((a, b) => PC_SLUGS.indexOf(a.slug) - PC_SLUGS.indexOf(b.slug));

const jamProjects = allProjects
  .filter((p) => JAM_SLUGS.includes(p.slug))
  .sort((a, b) => JAM_SLUGS.indexOf(a.slug) - JAM_SLUGS.indexOf(b.slug));
---

<Base title="All Projects â€” Dor Shem Tov">

  <section class="space-y-10">

    <!-- PAGE TITLE -->
    <h1 class="text-3xl sm:text-4xl font-bold text-accent">All Projects</h1>

    <!-- MOBILE GAMES GROUP -->
    <div class="space-y-4">
      <h2 class="text-2xl font-bold text-white">Mobile Games</h2>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-2">
        {mobileProjects.map((p) => (
          <a class="card block" href={`/projects/${p.slug}/`}>
            <img
              src={p.cover ?? "/images/hero-placeholder.svg"}
              alt={p.title}
              class="rounded-xl mb-3 w-full h-44 object-cover"
              loading="lazy"
            />
            <h3 class="text-lg font-semibold">{p.title}</h3>
            <p class="text-sm opacity-80">{p.summary}</p>

            {p.tags && p.tags.length > 0 && (
              <div class="mt-3 flex flex-nowrap gap-2 overflow-x-auto">
                {p.tags.map((t) => (
                  <span class="tag shrink-0">{t}</span>
                ))}
              </div>
            )}
          </a>
        ))}
      </div>
    </div>

    <!-- PC GAMES GROUP -->
    <div class="space-y-4">
      <h2 class="text-2xl font-bold text-white">PC Games</h2>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-2">
        {pcProjects.map((p) => (
          <a class="card block" href={`/projects/${p.slug}/`}>
            <img
              src={p.cover ?? "/images/hero-placeholder.svg"}
              alt={p.title}
              class="rounded-xl mb-3 w-full h-44 object-cover"
              loading="lazy"
            />
            <h3 class="text-lg font-semibold">{p.title}</h3>
            <p class="text-sm opacity-80">{p.summary}</p>

            {p.tags && p.tags.length > 0 && (
              <div class="mt-3 flex flex-nowrap gap-2 overflow-x-auto">
                {p.tags.map((t) => (
                  <span class="tag shrink-0">{t}</span>
                ))}
              </div>
            )}
          </a>
        ))}
      </div>
    </div>

    <!-- GLOBAL GAME JAMS GROUP -->
    <div class="space-y-4">
      <h2 class="text-2xl font-bold text-white">Global Game Jams</h2>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-2">
        {jamProjects.map((p) => (
          <a class="card block" href={`/projects/${p.slug}/`}>
            <img
              src={p.cover ?? "/images/hero-placeholder.svg"}
              alt={p.title}
              class="rounded-xl mb-3 w-full h-44 object-cover"
              loading="lazy"
            />
            <h3 class="text-lg font-semibold">{p.title}</h3>
            <p class="text-sm opacity-80">{p.summary}</p>

            {p.tags && p.tags.length > 0 && (
              <div class="mt-3 flex flex-nowrap gap-2 overflow-x-auto">
                {p.tags.map((t) => (
                  <span class="tag shrink-0">{t}</span>
                ))}
              </div>
            )}
          </a>
        ))}
      </div>
    </div>

  </section>

</Base>
